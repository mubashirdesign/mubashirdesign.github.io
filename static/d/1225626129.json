{"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"047e0038-e893-510d-adba-54c7122af117","html":"<p>JAMStack / Static Site generators come with a plethora of benefits as a developer over a traditional CMS like wordpress. With DevOps features built in natively, implementing automation, optimization, development and much more becomes almost dare I say easy.</p>\n<p><strong>So why is it not as widely adopted as wordpress or other CMS systems</strong>?</p>\n<p>Well there is no one solution that works for everyone, similar to how an exotic car wouldn't work well as a daily driver even though it could be superior in every manner.</p>\n<p><strong>Then the question is when would JAMStack be more effective than a CMS system?</strong></p>\n<p>Let's first pre-face this with the fact that this is mainly to the benefit of the in-house developer (you), as a solution for companies without an in-house dev this solution is definitely not as viable.</p>\n<p>Next you'll need to assess the current process of content management in your company, and then evaluate what performance actually means to the business.</p>\n<p>If your company has a content management team, uploading and managing content becomes the priority as the process has to be as easy as possible for them so scrapping the CMS system is not an option. There is however a work around, instead of building the static pages through markdown content, you could build the templates through querying the CMS API to pull all the inputted content by the content management team such as posts and blogs. This gives them the ease of uploading the content and you the developer the flexibilty to develop quickly and easily. This is generally when your CMS becomes headless as it isn't generating any pages but just providing data through the API. The key difference here is that the JAMStack site generates the content received from the CMS API into static files making it possible to distribute on a CDN making it unbeatable in terms of performance.</p>\n<p>Which leads us into the next part, what does performance actually mean to your company? This is where you'd determine if it's worth it to pitch JAMStack.</p>\n<p>To be continued....</p>","frontmatter":{"type":"blog","title":"Making the business case for JAMStack","path":"/3","date":"2020-01-12","excerpt":"Replacing the traditional CMS at the workplace"}}},{"node":{"id":"f7f7d07b-15c0-501e-9334-65048bc03014","html":"<p>This guide assumes you have access to the Shopify script editor which comes with Shopify Plus.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dfd46a1ad8e153dc5f0cfdfc6f881640/db585/scripteditor.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.967674661105319%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAP0lEQVQI15WMQQ7AIAgE/f9jqY1VQISVmH7ATSZ7mimtM55PQU1A+bYcEXHN0AWqL4pOO5FpyR+7XjruARbBBuaZnh8mL0irAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Script Editor\"\n        title=\"Script Editor\"\n        src=\"/static/dfd46a1ad8e153dc5f0cfdfc6f881640/11d19/scripteditor.png\"\n        srcset=\"/static/dfd46a1ad8e153dc5f0cfdfc6f881640/40714/scripteditor.png 200w,\n/static/dfd46a1ad8e153dc5f0cfdfc6f881640/a8246/scripteditor.png 400w,\n/static/dfd46a1ad8e153dc5f0cfdfc6f881640/11d19/scripteditor.png 800w,\n/static/dfd46a1ad8e153dc5f0cfdfc6f881640/db585/scripteditor.png 959w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>First we'll initialize the customer in the ruby source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">customer <span class=\"token operator\">=</span> <span class=\"token constant\">Input</span><span class=\"token punctuation\">.</span>cart<span class=\"token punctuation\">.</span>customer</code></pre></div>\n<p>Then we'll want to make the function that applies the discount based on the passed parameter</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">applyDiscount</span></span> <span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">,</span> discountAmount<span class=\"token punctuation\">)</span></code></pre></div>\n<p>In the function we'll loop through each line item in the cart and apply the discount by multiplying the line item price by the discount amount</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">Input</span><span class=\"token punctuation\">.</span>cart<span class=\"token punctuation\">.</span>line_items<span class=\"token punctuation\">.</span><span class=\"token keyword\">each</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>line_item<span class=\"token operator\">|</span>\nline_item<span class=\"token punctuation\">.</span>change_line_price<span class=\"token punctuation\">(</span>line_item<span class=\"token punctuation\">.</span>line_price <span class=\"token operator\">*</span> discountAmount<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">:</span> <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>message<span class=\"token delimiter tag\">}</span></span>\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>If we wanted the tag discount to only apply on certain products we can wrap the condition with an if statement</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">Input</span><span class=\"token punctuation\">.</span>cart<span class=\"token punctuation\">.</span>line_items<span class=\"token punctuation\">.</span><span class=\"token keyword\">each</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>line_item<span class=\"token operator\">|</span>\nproduct <span class=\"token operator\">=</span> line_item<span class=\"token punctuation\">.</span>variant<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">.</span>product_type\n<span class=\"token keyword\">if</span> product <span class=\"token operator\">==</span> <span class=\"token string\">\"Test\"</span>\nline_item<span class=\"token punctuation\">.</span>change_line_price<span class=\"token punctuation\">(</span>line_item<span class=\"token punctuation\">.</span>line_price <span class=\"token operator\">*</span> discountAmount<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">:</span> <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>message<span class=\"token delimiter tag\">}</span></span>\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>Now that the function is defined we'll need to determine with the customer is logged in</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">if</span> customer</code></pre></div>\n<p>Now we'll check for the specific tag that we are looking for</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">if</span> customer\n  <span class=\"token keyword\">if</span> customer<span class=\"token punctuation\">.</span>tags<span class=\"token punctuation\">.</span>include<span class=\"token operator\">?</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TestDiscount\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">#apply discount on TestDiscount tag for 50% on products</span>\n  applyDiscount <span class=\"token string\">\"Test Discount Applied\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>And that's it! The test discount will apply 50% to all products if the tag is present on the customer logged in.\nTo avoid overlapping with discount codes inputted you will need to check if the discount code is null or not first.</p>\n<p>Done.</p>\n<p>End State below:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 654px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d9843d47d6c21bd55a994ffdaaa3feb/ebbc9/endstate.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.22935779816513%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABtElEQVQ4y61U2Y7bMAz0///gAkXSLuxYvm/ZumxPh0rTh0USoMUSGFAmpBE5pJzsx4HN7wj7ARt2WOex6DV6sfM88cwk/hWMItmPE6MJ8CQc6FfrMS0axrqXB1/cES1xzsEaA2stnDUIIbwhuuNgVd577rfwrMrzjPDs+45knme0bYtpmtF1HYzZ3pYmJoRaa56ZsLGS1Vgs5JFkEsMPwwzXVXMjqN0RSZdliVm8In9mB+NJPwzoe4Oq6lFWNeq6gcoVsizjukehShSFipKc78R7aNgPY+xonre4XK5I0xQflw+kWYqybBhXxI0XVhjHMWYt5Eb041qqc95FL/FkpHaWne06y7LXCM3yZYOUvhGy3jaut/sh0U8gcenBw0ssadiQpnHwDt9iSd20GCcLVVbIqdUwjZg52L10fenR6g7jOsHyRhc85zW8JBONE1UUKOsOP66/kFGrW8WGNDk+qxRpc8O1+gkll84ay0ZQDtHuKWRscqXYxQV6kcEMcZYe2P8gfMEzMhls8VFDvbJLNkThrT0p7vb3xfyLxZLlRyBP5jssEq4cBUn3Pib/B6ksvmU+td+UHpOp4DwvNgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"End State\"\n        title=\"End State\"\n        src=\"/static/3d9843d47d6c21bd55a994ffdaaa3feb/ebbc9/endstate.png\"\n        srcset=\"/static/3d9843d47d6c21bd55a994ffdaaa3feb/40714/endstate.png 200w,\n/static/3d9843d47d6c21bd55a994ffdaaa3feb/a8246/endstate.png 400w,\n/static/3d9843d47d6c21bd55a994ffdaaa3feb/ebbc9/endstate.png 654w\"\n        sizes=\"(max-width: 654px) 100vw, 654px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"type":"blog","title":"Applying discounts based on customer tags in Shopify","path":"/2","date":"2020-01-10","excerpt":"Using the Shopify Script Editor"}}},{"node":{"id":"51070d78-2c2f-5a6d-8c39-65caa5b9fea7","html":"<p>This guide assumes you have some basic knowledge on themekit to deploy changes to Shopify via your local environment.</p>\n<p>The overall idea is to have the azure pipeline execute commands with the themekit CLI to deploy changes directly from your repository. This way you can negate pushing changes directly to the production environment and have it done through pull requests.</p>\n<p>So the first step is to connect your Shopify repo on your desktop to your azure devops environment. You can do this by creating a new repo on azure devops, then cloning it on your local environment and drop in your shopify files there and commit.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 471px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/abdd5392b1adc1c29e256831d23ceeb4/e933f/repo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.91082802547771%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABmklEQVQ4y6VUa1ODMBDs//936jhOZ3xAABtKyIu8E6wHWEyt1Truh2SGYW9v9w42MUYhpPOeMtosqOu3w1XYxBCCVXA476BQihPeZvxODt44gaWUPSUr4ZxMCEUI7fAupjFXdk7uGWXGmB9EgpfeO2dtXnMie0WGQVlnV81cebkMv6mrZ4z3p569NfyVMbooXyJbcVcWj5Ty5Z0TZSnFRfJ8a3ZTlY/gPCs4KztQ5hwG9q3bY9u3xfO26+hnvZns3ECUNkqpcRwvta35bV2/gOd8Cse0QZrzlNJFzxAYekJllcbxJDDLGxgVISSm9GnotG3Z3zdVUZaV1mbNbA7McG2mttfdOldue+F8BBK4XMWBbC1DPaW4bYGfTyJPWypbFAiVqEKVkMNxPUMYhJaDhLytc7PkeK4stWma13aHv+y2l0wsgELnu71cQg3gePuwJR0Bd2vbUXL4KnrKeItbiI30JI90AQxCaz0oBWeac53I3nsNUzYGnlo73e6j+Ws+yRB4z3rS4R3mgnfdXmlzuPJncPgHNvmu/hXv9ECSuXDrAzEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Repo\"\n        title=\"Repo\"\n        src=\"/static/abdd5392b1adc1c29e256831d23ceeb4/e933f/repo.png\"\n        srcset=\"/static/abdd5392b1adc1c29e256831d23ceeb4/40714/repo.png 200w,\n/static/abdd5392b1adc1c29e256831d23ceeb4/a8246/repo.png 400w,\n/static/abdd5392b1adc1c29e256831d23ceeb4/e933f/repo.png 471w\"\n        sizes=\"(max-width: 471px) 100vw, 471px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Note that the remote repo will not contain the config files to prevent overriding schema changes, you will however need it in your local repo to connect to Shopify via themekit</p>\n<p>Once the connection is established, add a .gitignore file and put in the below:</p>\n<h4>.gitignore</h4>\n<div class=\"gatsby-highlight\" data-language=\"git\"><pre class=\"language-git\"><code class=\"language-git\">config.yml\nconfig/settings_data.json\nconfig/settings_schema.json</code></pre></div>\n<p>The config file shouldn't be visible in the repo as it contains the api key that establishes the connection to the shopify cloud environment, leaving that exposed is a potential risk. We'll use pipeline variables to establish the connection in the next section.</p>\n<p>To allow the pipeline to execute the themekit commands We'll need to setup the package.json so that it installs the themekit CLI via npm and has the build script.</p>\n<p>Create the package.json file by running npm init or adding it manually. Drop in the code below:</p>\n<h4>package.json</h4>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"xxxxxxxxx\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Package to deploy our website via CD pipeline\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"shopify-themekit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^0.2.0\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"theme deploy\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ISC\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To start creating the pipeline file, add a \"azure-pipelines.yml\" file to your repo.</p>\n<p>Drop this code into the file as this is used for the initialization:</p>\n<h4>azure-pipelines.yml</h4>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">trigger</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">include</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">-</span> <span class=\"token string\">\"\\*\"</span>\n\n<span class=\"token key atrule\">pool</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">vmImage</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ubuntu-latest\"</span></code></pre></div>\n<p>Now in terms of execution steps drop this in:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">#Installs the themekit package from the package.json file</span>\n\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">task</span><span class=\"token punctuation\">:</span> Npm@1\n  <span class=\"token key atrule\">inputs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ci\"</span>\n  <span class=\"token key atrule\">workingDir</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\$(system.defaultworkingdirectory)/\"</span></code></pre></div>\n<p>The ci command will install from the package-lock.json file, the reason you want to do this is if you install from the package.json file it'll automatically update dependancies and if there are any broken dependancies it will fail. So to be safe you'll need to install from the package-lock.json file if your dependancies are working good.</p>\n<p>The next two steps will determine what branch to deploy from to the specified environment.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token comment\">#Runs the theme kit install command with the passed parameters IF the branch committed to is Master</span>\n<span class=\"token comment\">#themekit deploy pass=XXX, store==XX, themeid=XXX</span>\n\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">task</span><span class=\"token punctuation\">:</span> CmdLine@2\n  <span class=\"token key atrule\">condition</span><span class=\"token punctuation\">:</span> and(succeeded()<span class=\"token punctuation\">,</span> eq(variables<span class=\"token punctuation\">[</span><span class=\"token string\">'Build.SourceBranch'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> 'refs/heads/master'))\n  <span class=\"token key atrule\">inputs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"npm run build -- --password=$(productionPassword) --store=$(productionStoreUrl) --themeid=\\$(productionThemeId)\"</span>\n\n<span class=\"token comment\">#Runs the theme kit install command with the passed parameters IF the branch committed to is Test</span>\n<span class=\"token comment\">#themekit deploy pass=XXX, store==XX, themeid=XXX</span>\n\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">task</span><span class=\"token punctuation\">:</span> CmdLine@2\n  <span class=\"token key atrule\">condition</span><span class=\"token punctuation\">:</span> and(succeeded()<span class=\"token punctuation\">,</span> eq(variables<span class=\"token punctuation\">[</span><span class=\"token string\">'Build.SourceBranch'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> 'refs/heads/test'))\n  <span class=\"token key atrule\">inputs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"npm run build -- --password=$(testPassword) --store=$(testStoreUrl) --themeid=\\$(testThemeId)\"</span></code></pre></div>\n<p>Based on the condition, it will check whether you've committed to the test or master branch and based on that run the script below. In the script itself you can see three variables:</p>\n<h4>Environment Variables</h4>\n<table>\n<thead>\n<tr>\n<th>Prod</th>\n<th>Test</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>prodPassword</td>\n<td>testPassword</td>\n</tr>\n<tr>\n<td>prodStoreUrl</td>\n<td>testStoreUrl</td>\n</tr>\n<tr>\n<td>prodThemeId</td>\n<td>testThemeId</td>\n</tr>\n</tbody>\n</table>\n<p>These variables are set from azure pipeline, to get the values for password, storeurl and themeId refer to the themekit documentation <a href=\"https://shopify.github.io/themekit/\">https://shopify.github.io/themekit/</a></p>\n<p>To create and set the variables, go onto the azure devops gui, click edit on the pipeline then click on variables.</p>\n<p>Create all 6 variables with their respecitve values, when creating it, checkmark \"Keep this value secret\" as it will hide the variables from anyone else who accesses the pipeline.</p>\n<p>Now that everything is setup, you can do a test commit to either the test/master branch. Then just watch the pipeline queue a job and execute the script commands!</p>\n<p>Done.</p>","frontmatter":{"type":"blog","title":"Setting up a deployment pipeline for your Shopify site","path":"/1","date":"2019-12-28","excerpt":"Using Azure DevOps and ThemeKit CLI"}}}]}}}